<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editorial Dashboard - Sober Sidekick</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8f9fa;
            color: #333;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #2d5016 0%, #5a8f3a 100%);
            color: white;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 1.8em;
            font-weight: 600;
        }

        .nav-links {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 20px;
            background: rgba(255,255,255,0.2);
            transition: all 0.3s ease;
        }

        .nav-links a:hover {
            background: rgba(255,255,255,0.3);
        }

        /* Main Content */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            text-align: center;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: 700;
            color: #5a8f3a;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Action Buttons */
        .actions {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            background: #5a8f3a;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            background: #4a7a2a;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-danger {
            background: #dc3545;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        /* Content Sections */
        .section {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 30px;
            overflow: hidden;
        }

        .section-header {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .section-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #2d5016;
        }

        .section-content {
            padding: 0;
        }

        /* Content Table */
        .content-table {
            width: 100%;
            border-collapse: collapse;
        }

        .content-table th {
            background: #f8f9fa;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #495057;
            border-bottom: 2px solid #e9ecef;
            font-size: 0.9em;
        }

        .content-table td {
            padding: 15px;
            border-bottom: 1px solid #f1f3f4;
            vertical-align: top;
        }

        .content-table tr:hover {
            background: #f8f9fa;
        }

        .content-title {
            font-weight: 600;
            color: #2d5016;
            margin-bottom: 5px;
            line-height: 1.3;
        }

        .content-type {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            margin-bottom: 5px;
        }

        .type-research { background: #e3f2fd; color: #1976d2; }
        .type-story { background: #f3e5f5; color: #7b1fa2; }
        .type-video { background: #ffebee; color: #c62828; }
        .type-policy { background: #e8f5e8; color: #2e7d32; }
        .type-innovation { background: #fff3e0; color: #f57c00; }

        .content-excerpt {
            color: #666;
            font-size: 0.9em;
            line-height: 1.4;
        }

        .hope-rating {
            color: #ffd700;
            font-size: 1.1em;
        }

        .status {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-published {
            background: #d4edda;
            color: #155724;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .action-buttons {
            display: flex;
            gap: 8px;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 6px;
        }

        /* Add Content Form */
        .form-section {
            display: none;
            padding: 20px;
            background: #f8f9fa;
            border-top: 1px solid #e9ecef;
        }

        .form-section.active {
            display: block;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #5a8f3a;
        }

        .form-group textarea {
            height: 120px;
            resize: vertical;
        }

        .form-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
        }

        /* Loading and Empty States */
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }

            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
            }

            .actions {
                justify-content: center;
            }

            .content-table {
                font-size: 14px;
            }

            .content-table th,
            .content-table td {
                padding: 10px 8px;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Hidden elements */
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <h1>üìä Editorial Dashboard</h1>
            <nav class="nav-links">
                <a href="../newsfeed/">üì± View News Feed</a>
                <a href="../">üè† Home</a>
            </nav>
        </div>
    </header>

    <main class="container">
        <!-- Stats Section -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="stat-pending">-</div>
                <div class="stat-label">Pending Review</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="stat-published">-</div>
                <div class="stat-label">Published</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="stat-articles">-</div>
                <div class="stat-label">Articles</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="stat-videos">-</div>
                <div class="stat-label">Videos</div>
            </div>
        </div>

        <!-- Actions -->
        <div class="actions">
            <button class="btn" id="btn-add-content">‚ûï Add Content</button>
            <button class="btn btn-secondary" id="btn-load-sample">üì• Load Sample Data</button>
            <button class="btn btn-secondary" id="btn-export">üì§ Export Data</button>
            <button class="btn btn-danger" id="btn-clear-all">üóëÔ∏è Clear All Data</button>
        </div>

        <!-- Pending Content Section -->
        <section class="section">
            <div class="section-header">
                <h2 class="section-title">Pending Content</h2>
                <span id="pending-count" class="badge">0 items</span>
            </div>
            <div class="section-content">
                <div id="pending-content-table"></div>
            </div>
        </section>

        <!-- Published Content Section -->
        <section class="section">
            <div class="section-header">
                <h2 class="section-title">Published Content</h2>
                <span id="published-count" class="badge">0 items</span>
            </div>
            <div class="section-content">
                <div id="published-content-table"></div>
            </div>
        </section>

        <!-- Add Content Form (Hidden by default) -->
        <section class="section" id="add-content-section" style="display: none;">
            <div class="section-header">
                <h2 class="section-title">Add New Content</h2>
                <button class="btn btn-secondary btn-small" id="btn-cancel-add">‚úï Cancel</button>
            </div>
            <div class="section-content">
                <form class="form-section active" id="add-content-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="content-title">Title *</label>
                            <input type="text" id="content-title" required>
                        </div>
                        <div class="form-group">
                            <label for="content-type">Type *</label>
                            <select id="content-type" required>
                                <option value="">Select type...</option>
                                <option value="research">Research</option>
                                <option value="story">Story</option>
                                <option value="video">Video</option>
                                <option value="policy">Policy</option>
                                <option value="innovation">Innovation</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="content-author">Author *</label>
                            <input type="text" id="content-author" required>
                        </div>
                        <div class="form-group">
                            <label for="content-hope-rating">Hope Rating (1-5) *</label>
                            <select id="content-hope-rating" required>
                                <option value="">Select rating...</option>
                                <option value="1">1 ‚≠ê</option>
                                <option value="2">2 ‚≠ê‚≠ê</option>
                                <option value="3">3 ‚≠ê‚≠ê‚≠ê</option>
                                <option value="4">4 ‚≠ê‚≠ê‚≠ê‚≠ê</option>
                                <option value="5">5 ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="content-text">Content *</label>
                        <textarea id="content-text" required placeholder="Write your hope-focused content here..."></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" id="btn-save-draft">üìù Save as Draft</button>
                        <button type="submit" class="btn">üì§ Publish Now</button>
                    </div>
                </form>
            </div>
        </section>
    </main>

    <script>
        let contentData = [];

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', () => {
            loadContent();
            setupEventListeners();
        });

        // Load content from localStorage or JSON
        async function loadContent() {
            try {
                // First try localStorage (for local changes)
                const localData = localStorage.getItem('soberSidekickContent');
                if (localData) {
                    const data = JSON.parse(localData);
                    contentData = data.content || [];
                } else {
                    // Fall back to JSON file
                    const response = await fetch('../data/content.json');
                    const data = await response.json();
                    contentData = data.content || [];
                }
                
                updateStats();
                renderContent();
            } catch (error) {
                console.error('Error loading content:', error);
                loadSampleData();
            }
        }

        // Save content to localStorage
        function saveContent() {
            const data = {
                content: contentData,
                metadata: {
                    lastUpdated: new Date().toISOString(),
                    totalItems: contentData.length,
                    publishedItems: contentData.filter(item => item.status === 'published').length,
                    pendingItems: contentData.filter(item => item.status === 'pending').length,
                    version: '1.0.0'
                }
            };
            localStorage.setItem('soberSidekickContent', JSON.stringify(data));
        }

        // Update statistics
        function updateStats() {
            const pending = contentData.filter(item => item.status === 'pending').length;
            const published = contentData.filter(item => item.status === 'published').length;
            const articles = contentData.filter(item => ['research', 'story', 'policy', 'innovation'].includes(item.type)).length;
            const videos = contentData.filter(item => item.type === 'video').length;

            document.getElementById('stat-pending').textContent = pending;
            document.getElementById('stat-published').textContent = published;
            document.getElementById('stat-articles').textContent = articles;
            document.getElementById('stat-videos').textContent = videos;
        }

        // Generate content table HTML
        function generateContentTable(items, isPending = false) {
            if (items.length === 0) {
                return `
                    <div class="empty-state">
                        <div class="empty-state-icon">üì≠</div>
                        <h3>No ${isPending ? 'pending' : 'published'} content</h3>
                        <p>${isPending ? 'Add some content to get started!' : 'Publish some content to see it here.'}</p>
                    </div>
                `;
            }

            const tableRows = items.map(item => {
                const hopeStars = '‚≠ê'.repeat(item.hopeRating) + '‚òÜ'.repeat(5 - item.hopeRating);
                const statusClass = item.status === 'published' ? 'status-published' : 'status-pending';
                const excerpt = item.content.length > 100 ? item.content.substring(0, 100) + '...' : item.content;
                
                const actions = isPending ? 
                    `<button class="btn btn-small" onclick="publishContent('${item.id}')">üì§ Publish</button>
                     <button class="btn btn-danger btn-small" onclick="deleteContent('${item.id}')">üóëÔ∏è Delete</button>` :
                    `<button class="btn btn-secondary btn-small" onclick="unpublishContent('${item.id}')">üì• Unpublish</button>
                     <button class="btn btn-danger btn-small" onclick="deleteContent('${item.id}')">üóëÔ∏è Delete</button>`;

                return `
                    <tr>
                        <td>
                            <div class="content-title">${item.title}</div>
                            <span class="content-type type-${item.type}">${item.type}</span>
                            <div class="content-excerpt">${excerpt}</div>
                        </td>
                        <td>
                            <div class="hope-rating">${hopeStars}</div>
                            <small>${item.hopeRating}/5</small>
                        </td>
                        <td>
                            <span class="status ${statusClass}">${item.status}</span>
                        </td>
                        <td>
                            <small>${item.author || 'Unknown Author'}</small><br>
                            <small>${formatDate(item.createdAt)}</small>
                        </td>
                        <td>
                            <div class="action-buttons">
                                ${actions}
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');

            return `
                <table class="content-table">
                    <thead>
                        <tr>
                            <th>Content</th>
                            <th>Hope Rating</th>
                            <th>Status</th>
                            <th>Author & Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${tableRows}
                    </tbody>
                </table>
            `;
        }

        // Render content tables
        function renderContent() {
            const pendingContent = contentData.filter(item => item.status === 'pending');
            const publishedContent = contentData.filter(item => item.status === 'published');

            document.getElementById('pending-content-table').innerHTML = generateContentTable(pendingContent, true);
            document.getElementById('published-content-table').innerHTML = generateContentTable(publishedContent, false);

            document.getElementById('pending-count').textContent = `${pendingContent.length} items`;
            document.getElementById('published-count').textContent = `${publishedContent.length} items`;
        }

        // Format date
        function formatDate(dateString) {
            if (!dateString) return 'No date';
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { 
                month: 'short', 
                day: 'numeric',
                year: 'numeric'
            });
        }

        // Content actions
        function publishContent(id) {
            const item = contentData.find(item => item.id === id);
            if (item) {
                item.status = 'published';
                item.publishedAt = new Date().toISOString();
                item.updatedAt = new Date().toISOString();
                saveContent();
                updateStats();
                renderContent();
            }
        }

        function unpublishContent(id) {
            const item = contentData.find(item => item.id === id);
            if (item) {
                item.status = 'pending';
                item.publishedAt = '';
                item.updatedAt = new Date().toISOString();
                saveContent();
                updateStats();
                renderContent();
            }
        }

        function deleteContent(id) {
            if (confirm('Are you sure you want to delete this content?')) {
                contentData = contentData.filter(item => item.id !== id);
                saveContent();
                updateStats();
                renderContent();
            }
        }

        // Add new content
        function addNewContent(formData, publish = false) {
            const newItem = {
                id: 'item_' + Date.now(),
                title: formData.title,
                type: formData.type,
                content: formData.content,
                hopeRating: parseInt(formData.hopeRating),
                status: publish ? 'published' : 'pending',
                createdAt: new Date().toISOString(),
                publishedAt: publish ? new Date().toISOString() : '',
                updatedAt: new Date().toISOString(),
                author: formData.author,
                readTime: estimateReadTime(formData.content),
                tags: generateTags(formData.type)
            };

            contentData.unshift(newItem); // Add to beginning
            saveContent();
            updateStats();
            renderContent();
            
            // Reset form and hide section
            document.getElementById('add-content-form').reset();
            document.getElementById('add-content-section').style.display = 'none';
        }

        // Estimate read time
        function estimateReadTime(content) {
            const wordsPerMinute = 200;
            const wordCount = content.split(/\s+/).length;
            const minutes = Math.ceil(wordCount / wordsPerMinute);
            return `${minutes} min read`;
        }

        // Generate tags based on type
        function generateTags(type) {
            const tagMap = {
                research: ['research', 'science', 'study'],
                story: ['personal story', 'experience', 'journey'],
                video: ['video', 'watch', 'visual'],
                policy: ['policy', 'healthcare', 'system'],
                innovation: ['innovation', 'technology', 'new']
            };
            return tagMap[type] || ['general'];
        }

        // Load sample data
        function loadSampleData() {
            contentData = [
                {
                    id: 'item_001',
                    title: 'Breakthrough Research: Brain Healing Continues Years Into Recovery',
                    type: 'research',
                    content: 'New neuroplasticity studies show the brain continues healing and building new pathways well into long-term recovery. This groundbreaking research offers hope for anyone wondering if it\'s "too late" to heal. Scientists at Johns Hopkins found that people with 5+ years of sobriety showed continued improvement in cognitive function, emotional regulation, and decision-making abilities.',
                    hopeRating: 4,
                    status: 'published',
                    createdAt: '2025-01-15T08:00:00Z',
                    publishedAt: '2025-01-15T08:00:00Z',
                    updatedAt: '2025-01-15T08:00:00Z',
                    author: 'Dr. Sarah Chen, Neuroscience Research',
                    readTime: '4 min read',
                    tags: ['research', 'brain health', 'recovery science']
                },
                {
                    id: 'item_002',
                    title: 'Daily Motivation: You Are Stronger Than You Know',
                    type: 'video',
                    content: 'A powerful 3-minute reminder that every day you choose recovery, you\'re proving your incredible strength. Your journey matters, and your progress is real. This motivational video features real recovery stories and gentle reminders of your resilience.',
                    hopeRating: 5,
                    status: 'published',
                    createdAt: '2025-01-14T12:00:00Z',
                    publishedAt: '2025-01-14T12:00:00Z',
                    updatedAt: '2025-01-14T12:00:00Z',
                    author: 'Recovery Support Team',
                    readTime: '3 min watch',
                    tags: ['motivation', 'daily inspiration', 'strength']
                },
                {
                    id: 'item_009',
                    title: 'The Science of Hope: Why Optimism Accelerates Recovery',
                    type: 'research',
                    content: 'Stanford researchers reveal how cultivating hope creates measurable changes in brain chemistry that support long-term sobriety and emotional wellbeing. The study followed 200 participants over 3 years, showing that those who practiced hope-building exercises had 40% better recovery outcomes.',
                    hopeRating: 4,
                    status: 'pending',
                    createdAt: '2025-01-16T10:00:00Z',
                    publishedAt: '',
                    updatedAt: '2025-01-16T10:00:00Z',
                    author: 'Dr. James Liu, Stanford Recovery Research',
                    readTime: '8 min read',
                    tags: ['research', 'hope', 'brain science']
                },
                {
                    id: 'item_010',
                    title: 'Recovery Workout: Building Physical and Mental Strength',
                    type: 'video',
                    content: 'This 20-minute routine combines physical exercise with mindfulness practices, designed to boost endorphins naturally and build confidence in your recovery journey. No equipment needed - just your commitment to feeling stronger every day.',
                    hopeRating: 4,
                    status: 'pending',
                    createdAt: '2025-01-17T15:00:00Z',
                    publishedAt: '',
                    updatedAt: '2025-01-17T15:00:00Z',
                    author: 'Fitness Recovery Team',
                    readTime: '20 min workout',
                    tags: ['fitness', 'workout', 'mental health']
                }
            ];

            saveContent();
            updateStats();
            renderContent();
        }

        // Export data
        function exportData() {
            const data = {
                content: contentData,
                metadata: {
                    lastUpdated: new Date().toISOString(),
                    totalItems: contentData.length,
                    publishedItems: contentData.filter(item => item.status === 'published').length,
                    pendingItems: contentData.filter(item => item.status === 'pending').length,
                    version: '1.0.0'
                }
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'sober-sidekick-content.json';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Clear all data
        function clearAllData() {
            if (confirm('Are you sure you want to delete ALL content? This cannot be undone.')) {
                contentData = [];
                localStorage.removeItem('soberSidekickContent');
                updateStats();
                renderContent();
            }
        }

        // Setup event listeners
        function setupEventListeners() {
            // Add content button
            document.getElementById('btn-add-content').addEventListener('click', () => {
                document.getElementById('add-content-section').style.display = 'block';
                document.getElementById('content-title').focus();
            });

            // Cancel add content
            document.getElementById('btn-cancel-add').addEventListener('click', () => {
                document.getElementById('add-content-section').style.display = 'none';
                document.getElementById('add-content-form').reset();
            });

            // Add content form submission
            document.getElementById('add-content-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const formData = {
                    title: document.getElementById('content-title').value,
                    type: document.getElementById('content-type').value,
                    content: document.getElementById('content-text').value,
                    author: document.getElementById('content-author').value,
                    hopeRating: document.getElementById('content-hope-rating').value
                };
                addNewContent(formData, true); // Publish immediately
            });

            // Save as draft
            document.getElementById('btn-save-draft').addEventListener('click', () => {
                const formData = {
                    title: document.getElementById('content-title').value,
                    type: document.getElementById('content-type').value,
                    content: document.getElementById('content-text').value,
                    author: document.getElementById('content-author').value,
                    hopeRating: document.getElementById('content-hope-rating').value
                };
                addNewContent(formData, false); // Save as draft
            });

            // Other action buttons
            document.getElementById('btn-load-sample').addEventListener('click', () => {
                if (confirm('This will load sample data. Continue?')) {
                    loadSampleData();
                }
            });

            document.getElementById('btn-export').addEventListener('click', exportData);
            document.getElementById('btn-clear-all').addEventListener('click', clearAllData);
        }

        // Make functions available globally for onclick handlers
        window.publishContent = publishContent;
        window.unpublishContent = unpublishContent;
        window.deleteContent = deleteContent;
    </script>
</body>
</html>